---
sidebar: sidebar 
permalink: use/protect-apps.html 
keywords: backup, back up, backup apps, back up apps, snapshots, snapshot an app, take a snapshot, take a backup, view backups, view snapshots, set policy, set schedule, schedule backups, schedule snapshots 
summary: 自動保護ポリシーまたはアドホックベースを使用してスナップショットやバックアップを作成することで、アプリケーションを保護します。 
---
= Snapshot とバックアップでアプリケーションを保護
:hardbreaks:
:icons: font
:imagesdir: ../media/use/


自動保護ポリシーまたはアドホックベースを使用してスナップショットやバックアップを作成することで、アプリケーションを保護します。Astra の UI またはを使用できます https://docs.netapp.com/us-en/astra-automation/index.html["Astra Control API"^] アプリを保護します。


NOTE: Helm を使用してアプリケーションを展開する場合、 Astra Control Center には Helm バージョン 3 が必要です。Helm 3 （または Helm 2 から Helm 3 にアップグレード）を使用して展開されたアプリケーションの管理とクローニングが完全にサポートされています。Helm 2 で展開されたアプリケーションはサポートされていません。

[NOTE]
====
OpenShift クラスタでアプリケーションをホストするプロジェクトを作成すると、プロジェクト（または Kubernetes ネームスペース）に SecurityContext UID が割り当てられます。Astra Control Center でアプリケーションを保護し、 OpenShift でそのアプリケーションを別のクラスタまたはプロジェクトに移動できるようにするには、アプリケーションを任意の UID として実行できるようにポリシーを追加する必要があります。たとえば、次の OpenShift CLI コマンドは、 WordPress アプリケーションに適切なポリシーを付与します。

OC new-project ワードプレス ` OC adm policy add -scc to -group anyuid system: serviceaccounts:wordpress `OC adm policy add -scc to -user Privileged -z default-n wordpress

====


== Snapshot とバックアップ

a_snapshot_は 、アプリケーションと同じプロビジョニングボリュームに格納されるアプリケーションのポイントインタイムコピーです。通常は高速です。ローカル Snapshot を使用して、アプリケーションを以前の時点にリストアします。スナップショットは高速クローンに便利です。スナップショットには、構成ファイルを含む、アプリケーションのすべての Kubernetes オブジェクトが含まれます。

a_backup_ は外部のオブジェクトストアに格納されます。バックアップは、ローカル Snapshot に比べて時間がかかる場合があります。アプリケーションのバックアップを別のクラスタにリストアすることで、アプリケーションを移行できます。バックアップの保持期間を延長することもできます。


CAUTION: _ 最新のバックアップがあるまで、完全に保護することはできません _ 。これは、永続ボリュームから離れたオブジェクトストアにバックアップが格納されるために重要です。障害や事故によってクラスタと永続的ストレージが消去された場合は、バックアップをリカバリする必要があります。スナップショットを使用してリカバリすることはできません。



== 保護ポリシーを設定します

保護ポリシーは、定義されたスケジュールでスナップショット、バックアップ、またはその両方を作成することでアプリケーションを保護します。Snapshot とバックアップを毎時、日次、週次、および月単位で作成し、保持するコピーの数を指定できます。

.手順
. 「 * アプリケーション」を選択し、アプリケーションの名前を選択します。
. [ * データ保護 * ] を選択します。
. ［ 保護ポリシーの設定 ］ を選択します。
. 毎時、日次、週次、および月単位で保持する Snapshot とバックアップの数を選択して、保護スケジュールを定義します。
+
スケジュールは、毎時、毎日、毎週、および毎月の各スケジュールで同時に定義できます。保持レベルを設定するまで、スケジュールはアクティブになりません。

+
次の例では、 Snapshot とバックアップの保護スケジュールとして、毎時、毎日、毎週、毎月の 4 つを設定します。

+
image:screenshot-config-protection-policy.png["Snapshot とバックアップを毎時、毎日、毎週、または毎月作成する設定ポリシーの例のスクリーンショット。"]

. [* Review （レビュー） ] を選択します
. ［ * 保護ポリシーの設定 * ］ を選択します


Astra Control Center は、定義したスケジュールと保持ポリシーを使用して、スナップショットとバックアップを作成し、保持することによって、データ保護ポリシーを実装します。



== Snapshot を作成します

オンデマンド Snapshot はいつでも作成できます。

.手順
. 「 * アプリケーション * 」を選択します。
. 目的のアプリケーションの [ * アクション * （ * Actions * ） ] 列でドロップダウンリストを選択します。
. 「 * Snapshot * 」を選択します。
. スナップショットの名前をカスタマイズし、 * Review * を選択します。
. Snapshot の概要を確認し、「 * Snapshot * 」を選択します。


スナップショットプロセスが開始されます。スナップショットは、ステータスが「 * 使用可能 * 」である場合に成功します。この場合、「 * データ保護 * > * スナップショット * 」ページの「 * アクション * 」列に表示されます。



== バックアップを作成します

アプリケーションはいつでもバックアップできます。


NOTE: Astra Control Center の S3 バケットは、使用可能容量を報告しません。Astra Control Center で管理されているアプリケーションのバックアップまたはクローニングを行う前に、 ONTAP または StorageGRID 管理システムでバケット情報を確認します。

.手順
. 「 * アプリケーション * 」を選択します。
. 目的のアプリケーションの [ * アクション * （ * Actions * ） ] 列でドロップダウンリストを選択します。
. 「 * Backup * 」を選択します。
. バックアップ名をカスタマイズする。
. 既存のスナップショットからアプリケーションをバックアップするかどうかを選択します。このオプションを選択すると、既存の Snapshot のリストから選択できます。
. ストレージバケットのリストから選択して、バックアップのデスティネーションを選択します。
. [* Review （レビュー） ] を選択します
. バックアップの概要を確認し、「 * Backup * 」を選択します。


Astra Control Center は、アプリケーションのバックアップを作成します。


NOTE: ネットワークに障害が発生している場合や、処理速度が異常に遅い場合は、バックアップ処理がタイムアウトする可能性があります。その結果、バックアップは失敗します。


NOTE: 実行中のバックアップを停止する方法はありません。バックアップを削除する必要がある場合は、完了するまで待ってから、の手順を実行してください <<Delete backups>>。失敗したバックアップを削除するには、 https://docs.netapp.com/us-en/astra-automation/index.html["Astra Control API を使用"^]。


NOTE: データ保護処理（クローン、バックアップ、リストア）が完了して永続ボリュームのサイズを変更したあと、新しいボリュームのサイズが UI に表示されるまでに最大 20 分かかります。データ保護処理にかかる時間は数分です。また、ストレージバックエンドの管理ソフトウェアを使用してボリュームサイズの変更を確認できます。



== Snapshot とバックアップを表示します

アプリケーションのスナップショットとバックアップは、 [ データ保護（ Data Protection ） ] タブで表示できます。

.手順
. 「 * アプリケーション」を選択し、アプリケーションの名前を選択します。
. [ * データ保護 * ] を選択します。
+
デフォルトでは、 Snapshot が表示されます。

. バックアップのリストを表示するには、「 * Backups * 」を選択します。




== Snapshot を削除します

不要になったスケジュール済みまたはオンデマンドの Snapshot を削除します。

.手順
. 「 * アプリケーション」を選択し、アプリケーションの名前を選択します。
. [ * データ保護 * ] を選択します。
. 目的のスナップショットの [* アクション * （ * Actions * ） ] 列でドロップダウンリストを選択します。
. 「 * スナップショットの削除 * 」を選択します。
. 削除を確認するために「 delete 」と入力し、「 * はい、 Snapshot を削除します * 」を選択します。


Astra Control Center がスナップショットを削除します。



== バックアップを削除します

不要になったスケジュール済みまたはオンデマンドのバックアップを削除します。


NOTE: 実行中のバックアップを停止する方法はありません。バックアップを削除する必要がある場合は、完了するまで待ってから、以下の手順を実行してください。失敗したバックアップを削除するには、 https://docs.netapp.com/us-en/astra-automation/index.html["Astra Control API を使用"^]。

. 「 * アプリケーション」を選択し、アプリケーションの名前を選択します。
. [ * データ保護 * ] を選択します。
. 「 * Backups * 」を選択します。
. 目的のバックアップの [* アクション * ] 列のドロップダウン・リストを選択します。
. [ * バックアップの削除 * ] を選択します。
. 削除を確認するために「 delete 」と入力し、「 * はい、バックアップを削除 * 」を選択します。


Astra Control Center はバックアップを削除します。
