---
sidebar: sidebar 
permalink: use/manage-apps.html 
keywords: how to manage apps with astra control, discover app, how to manage kubernetes apps, astra control, astra 
summary: 'Kubernetes クラスタを Astra Control に追加したら、そのクラスタ（ Astra Control の外部）にアプリをインストールし、 Astra Control の [ アプリ ] ページに移動してアプリの管理を開始できます。' 
---
= アプリの管理を開始します
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/use/


お先にどうぞ link:../get-started/setup_overview.html#add-cluster["Astra Control 管理にクラスタを追加"]では、クラスターにアプリケーションをインストールし（ Astra Control の外部）、 Astra Control の [ アプリ ] ページに移動して、アプリケーションとそのリソースの管理を開始できます。



== アプリケーション管理の要件

Astra Control には、次のアプリケーション管理要件があります。

* * ライセンス * ： Astra Control Center を使用してアプリケーションを管理するには、 Astra Control Center ライセンスが必要です。
* * 名前空間 * ： Astra Control では、アプリケーションが複数の名前空間にまたがることはありませんが、名前空間には複数のアプリケーションを含めることができます。
* * StorageClass* ： StorageClass が明示的に設定されたアプリケーションをインストールし、そのアプリケーションをクローニングする必要がある場合、クローン処理のターゲットクラスタに最初に指定された StorageClass が必要です。明示的に StorageClass を設定したアプリケーションを、同じストレージクラスを使用しないクラスタにクローニングすると、失敗します。
* * Kubernetes リソース * ： Astra Control で収集されない Kubernetes リソースを使用するアプリケーションには、アプリケーションデータの完全な管理機能がない可能性があります。Astra Control では、次の Kubernetes リソースが収集されます。
+
[cols="1,1,1"]
|===


| クラスタロール | ClusterRoleBinding | ConfigMap 


| CustomResourceDefinition の場合 | CustomResource の場合 | cronjob 


| デモンセット（ DemonSet ） | HorizontalPodAutoscaler のように表示されます | 入力 


| DeploymentConfig | MutingWebhook | PersistentVolumeClaim のように表示され 


| ポッド | PodDisruptionBudget （予算の廃止） | PodTemplate 


| ネットワークポリシー | ReplicaSet | ロール 


| RoleBinding です | ルート | 秘密 


| サービス | サービスアカウント | Stateful役立つ セット 


| 検証 Webhook |  |  
|===




=== サポートされているアプリインストール方法

Astra Control は、次のアプリケーションインストール方法をサポートしています。

* * マニフェストファイル * ： Astra Control は、 kubectl を使用してマニフェストファイルからインストールされたアプリケーションをサポートします。例：
+
[listing]
----
kubectl apply -f myapp.yaml
----
* * Helm 3 * ： Helm を使用してアプリケーションをインストールする場合、 Astra Control には Helm バージョン 3 が必要です。Helm 3 （または Helm 2 から Helm 3 にアップグレード）を使用してインストールされたアプリケーションの管理とクローニングが完全にサポートされています。Helm 2 でインストールされたアプリケーションの管理はサポートされていません。
* * オペレータが導入したアプリケーション * ： Astra Control は、名前空間を対象とした演算子を使用してインストールされたアプリケーションをサポートします。これらの演算子は、一般に「パスバイリファレンス」アーキテクチャではなく「パスバイ値」で設計されています。これらのパターンに続くいくつかのオペレータアプリを次に示します。
+
** https://github.com/k8ssandra/cass-operator/tree/v1.7.1["Apache K8ssandra"^]
** https://github.com/jenkinsci/kubernetes-operator["Jenkins CI"^]
** https://github.com/percona/percona-xtradb-cluster-operator["Percona XtraDB クラスタ"^]




Astra Control では、「パスバイリファレンス」アーキテクチャ（ CockroachDB オペレータなど）で設計されたオペレータをクローニングできない場合があります。クローニング処理では、クローニング処理の一環として独自の新しいシークレットが存在する場合でも、クローニングされたオペレータがソースオペレータから Kubernetes シークレットを参照しようとします。Astra Control がソースオペレータの Kubernetes シークレットを認識しないため、クローニング処理が失敗する場合があります。


NOTE: インストールする演算子とアプリケーションは、同じ名前空間を使用する必要があります。このような名前空間を使用するには、演算子の deployment.yaml ファイルを変更する必要があります。



== クラスタにアプリをインストールします

Astra Control にクラスタを追加したので、クラスタにアプリケーションをインストールしたり、既存のアプリケーションを管理したりできます。名前空間にスコープ指定されているアプリケーションはすべて管理できます。ポッドがオンラインになったら、 Astra Control を使用してアプリケーションを管理できます。

Helm チャートから検証済みのアプリケーションを展開する方法については、次を参照してください。

* link:../solutions/mariadb-deploy-from-helm-chart.html["Helm チャートから MariaDB を導入します"]
* link:../solutions/mysql-deploy-from-helm-chart.html["Helm チャートから MySQL を導入します"]
* link:../solutions/postgres-deploy-from-helm-chart.html["Helm チャートから Postgres を導入します"]
* link:../solutions/jenkins-deploy-from-helm-chart.html["Helm チャートから Jenkins をデプロイします"]




== アプリの管理

Astra Control を使用すると、アプリケーションをネームスペースレベルまたは Kubernetes ラベルで管理できます。


NOTE: Helm 2 でインストールされたアプリケーションはサポートされていません。

次のアクティビティを実行して、アプリケーションを管理できます。

* アプリの管理
+
** <<Manage apps by namespace>>
** <<Manage apps by Kubernetes label>>


* <<Ignore apps>>
* <<Unmanage apps>>



TIP: Astra Control 自体は標準のアプリケーションではなく、「システムアプリケーション」です。 Astra Control 自体は管理しないでください。Astra Control 自体は、管理用にデフォルトでは表示されません。システムアプリを表示するには、「システムアプリを表示」フィルタを使用します。

Astra Control API を使用してアプリケーションを管理する方法については、を参照してください link:https://docs.netapp.com/us-en/astra-automation/["Astra の自動化と API に関する情報"^]。


NOTE: データ保護処理（クローン、バックアップ、リストア）が完了して永続ボリュームのサイズを変更したあと、新しいボリュームのサイズが UI に表示されるまでに最大 20 分かかります。データ保護処理にかかる時間は数分です。また、ストレージバックエンドの管理ソフトウェアを使用してボリュームサイズの変更を確認できます。



=== ネームスペースでアプリケーションを管理します

アプリページの * 検出された * セクションには、名前空間と Helm がインストールされたアプリ、またはそれらの名前空間内のカスタムラベル付きアプリが表示されます。各アプリケーションを個別に管理することも、ネームスペースレベルで管理することもできます。データ保護処理に必要な精度のレベルが重要になります。

たとえば、毎週同じ頻度で「 Maria 」のバックアップポリシーを設定したいのに、同じネームスペースにある「 MariaDB 」をバックアップする頻度を高く設定するとします。これらのニーズに基づいて、アプリケーションを個別に管理する必要があり、単一のネームスペースで管理する必要はありません。

Astra Control を使用すると、階層の両方のレベル（名前空間とその名前空間内のアプリケーション）を個別に管理できますが、いずれか一方を選択することをお勧めします。Astra Control で実行したアクションは、ネームスペースレベルとアプリケーションレベルの両方で同時に実行される場合、失敗する可能性があります。

.手順
. 左側のナビゲーションバーから、「 * アプリケーション * 」を選択します。
. [* Discovered * （検出されました * ） ] フィルタ
+
image:acc_apps_discovered4.png["検出されたアプリフィルターのスクリーンショット"]

. 検出されたネームスペースのリストを表示します。ネームスペースを展開して、アプリケーションおよび関連するリソースを表示します。
+
Astra Control では、 Helm アプリケーションとカスタムラベルの付いたアプリケーションがネームスペースに表示されます。Helm ラベルがある場合は、タグアイコンで指定されます。

. [*Group*] 列を参照して、アプリケーションが実行している名前空間を確認します ( フォルダアイコンで指定されています ) 。
. 各アプリケーションを個別に管理するか、ネームスペースレベルで管理するかを決定します。
. 階層内の目的のレベルで目的のアプリケーションを検索し、 [ アクション * ] 列の [ オプション ] メニューから [ * 管理 * ] を選択します。
. アプリを管理しない場合は、 [ アクション * ] 列の [ オプション ] メニューから [ * 無視 * ] を選択します。
+
たとえば、「 Maria 」ネームスペースの下にあるすべてのアプリケーションを同じスナップショットポリシーとバックアップポリシーで管理したい場合は、ネームスペースを管理し、ネームスペース内のアプリケーションは無視してください。

. 管理対象アプリのリストを表示するには、表示フィルターとして「 * 管理対象 * 」を選択します。
+
image:acc_apps_managed3.png["管理アプリフィルタのスクリーンショット"]

+

NOTE: 追加したアプリケーションの保護列に警告アイコンが表示されている場合は、バックアップされておらず、まだバックアップのスケジュールが設定されていないことを示しています。

. 特定のアプリケーションの詳細を表示するには、アプリケーション名を選択します。


管理対象として選択したアプリは、 [ 管理対象 * ] タブから利用できるようになりました。無視されたアプリは、 * 無視された * タブに移動します。新しいアプリケーションがインストールされると、検出されたタブにはアプリが表示されないため、見つけやすくなり、管理も簡単になります。



=== Kubernetes ラベルでアプリケーションを管理

Astra Control の [ アプリ ] ページの上部には、「 * カスタムアプリの定義 * 」という名前のアクションが含まれています。このアクションを使用して、 Kubernetes ラベルで識別されるアプリケーションを管理できます。 link:../use/define-custom-app.html["Kubernetes ラベルでカスタムアプリケーションを定義する方法については、こちらをご覧ください"]。

.手順
. 左側のナビゲーションバーから、「 * アプリケーション * 」を選択します。
. [ * 定義（ Define ） ] を選択します
. [ * カスタムアプリケーションの定義 * （ Define custom application * ） ] ダイアログボックスで、アプリケーションを管理するために必要な情報を入力します。
+
.. * 新しいアプリ * ：アプリの表示名を入力します。
.. * クラスタ * ：アプリケーションが存在するクラスタを選択します。
.. * 名前空間： * アプリケーションの名前空間を選択します。
.. * ラベル： * ラベルを入力するか、以下のリソースからラベルを選択してください。
.. * 選択したリソース * ：保護する Kubernetes リソース（ポッド、シークレット、永続ボリュームなど）を表示および管理します。
+
*** リソースを展開し、ラベル数を選択して、使用可能なラベルを表示します。
*** ラベルを 1 つ選択します。
+
ラベルを選択すると、 [*Label*] フィールドにラベルが表示されます。Astra Control は、 [ 選択されていないリソース * ] セクションも更新して、選択したラベルと一致しないリソースを表示します。



.. * 選択されていないリソース * ：保護する必要がないアプリケーションリソースを確認します。


. 「 * カスタムアプリケーションの定義 * 」を選択します。


Astra Control を使用すると、アプリケーションを管理できます。これで、 [* 管理対象 * （ * Managed * ） ] タブに表示されます。



== アプリケーションを無視します

検出されたアプリケーションは、検出されたリストに表示されます。この場合は、新しくインストールされたアプリケーションを簡単に検索できるように、検出されたリストをクリーンアップできます。また、管理しているアプリケーションがあり、後でそれらを管理する必要がなくなる場合もあります。これらのアプリケーションを管理したくない場合は、無視するように指定できます。

また、アプリケーションを 1 つのネームスペースで同時に管理することもできます（ネームスペース管理）。ネームスペースから除外するアプリケーションは無視してかまいません。

.手順
. 左側のナビゲーションバーから、「 * アプリケーション * 」を選択します。
. フィルタとして * Discovered * を選択します。
. アプリケーションを選択します。
. [ * アクション * （ * Actions * ） ] 列の [ オプション（ Options ） ] メニューから、 [ * 無視 * （ * Ignore * ） ] を選択
. 無視を解除するには、 * 無視解除 * を選択します。




== アプリの管理を解除します

アプリケーションのバックアップ、スナップショット、またはクローンを作成する必要がなくなった場合は、管理を停止できます。


NOTE: アプリケーションの管理を解除すると、以前に作成したバックアップやスナップショットは失われます。

.手順
. 左側のナビゲーションバーから、「 * アプリケーション * 」を選択します。
. フィルタとして [*Managed] を選択します。
. アプリケーションを選択します。
. * アクション * 列のオプションメニューから、 * 管理解除 * を選択します。
. 情報を確認します。
. 「 unmanage 」と入力して確定します。
. [ はい、アプリケーションの管理を解除 * ] を選択します。




== システムアプリケーションについて教えてください。

Astra Control は、 Kubernetes クラスタで実行されているシステムアプリケーションも検出します。これらのシステムアプリは、バックアップが必要になることが稀であるため、デフォルトでは表示されません。

ツールバーのクラスターフィルターの下にあるシステムアプリを表示 * システムアプリを表示 * チェックボックスをオンにすると、アプリケーションページからシステムアプリを表示できます。

image:acc_apps_system_apps3.png["アプリケーション（ Apps ）ページで使用可能なシステムアプリケーションを表示（ Show System Apps ）オプションを示すスクリーンショット。"]


TIP: Astra Control 自体は標準のアプリケーションではなく、「システムアプリケーション」です。 Astra Control 自体は管理しないでください。Astra Control 自体は、管理用にデフォルトでは表示されません。



== 詳細については、こちらをご覧ください

* https://docs.netapp.com/us-en/astra-automation/index.html["Astra Control API を使用"^]

