---
sidebar: sidebar 
permalink: get-started/acc_operatorhub_install.html 
keywords: how to install astra control center, operator, operatorhub, openshift, install astra control center operator 
summary: Red Hat OpenShift を使用する場合は、オペレータを使用して Astra Control Center をインストールできます。 
---
= OpenShift OperatorHub を使用して Astra Control Center をインストールします
:hardbreaks:
:allow-uri-read: 
:icons: font
:imagesdir: ../media/get-started/


[role="lead"]
Red Hat OpenShift を使用する場合は、 Red Hat 認定オペレータを使用して Astra Control Center をインストールできます。この手順を使用して、から Astra Control Center をインストールします https://catalog.redhat.com/software/operators/explore["Red Hat エコシステムカタログ"^] または、 Red Hat OpenShift Container Platform を使用します。

この手順を完了したら、インストール手順に戻ってを実行する必要があります link:../get-started/install_acc.html#verify-system-status["残りのステップ"] インストールが成功したかどうかを確認し、ログオンします。

.必要なもの
* link:requirements.html["インストールを開始する前に、 Astra Control Center の導入環境を準備します"]。
* OpenShiftクラスタから、すべてのクラスタオペレータが正常な状態にあることを確認します。
+
[source, console]
----
oc get clusteroperators
----
* OpenShiftクラスタから、すべてのAPIサービスが正常な状態であることを確認します。
+
[source, console]
----
oc get apiservices
----
* データセンターにAstra Control CenterのFQDNアドレスを作成します。
* 説明したインストール手順を実行するために必要な権限を取得し、Red Hat OpenShift Container Platformにアクセスします。
* クラスタにcert-managerがすでに存在する場合は、いくつかを実行する必要があります link:../get-started/cert-manager-prereqs.html["事前に必要な手順"] そのため、Astra Control Centerは独自の証明書管理ツールをインストールしません。デフォルトでは、Astra Control Centerはインストール時に独自の証明書マネージャをインストールします。


.手順
*  and unpack the Astra Control Center bundle
*  the NetApp Astra kubectl plugin
*  the images to your local registry
*  the operator install page
*  the operator
*  Astra Control Center




== Astra Control Centerバンドルをダウンロードして開梱します

. から Astra Control Center バンドル（「 Astra - control-ccenter-[version].tar.gz` ）をダウンロードします https://mysupport.netapp.com/site/products/all/details/astra-control-center/downloads-tab["ネットアップサポートサイト"^]。
. から Astra Control Center 証明書とキーの zip をダウンロードします https://mysupport.netapp.com/site/products/all/details/astra-control-center/downloads-tab["ネットアップサポートサイト"^]。
. （任意）バンドルのシグニチャを確認します。
+
[source, console]
----
openssl dgst -sha256 -verify AstraControlCenter-public.pub -signature astra-control-center-[version].tar.gz.sig astra-control-center-[version].tar.gz
----
. 画像を抽出します。
+
[source, console]
----
tar -vxzf astra-control-center-[version].tar.gz
----




== ネットアップAstra kubectlプラグインをインストール

NetApp Astra kubectlコマンドラインプラグインは、Astra Control Centerの導入とアップグレードに関連する一般的なタスクを実行する際に時間を節約します。

ネットアップでは、CPUアーキテクチャやオペレーティングシステム別にプラグインのバイナリを提供しています。このタスクを実行する前に、使用しているCPUとオペレーティングシステムを把握しておく必要があります。

.手順
. 使用可能なNetApp Astra kubectlプラグインのバイナリを表示し、オペレーティングシステムとCPUアーキテクチャに必要なファイルの名前をメモします。
+

NOTE: kubectlプラグインライブラリはtarバンドルの一部であり、フォルダに解凍されます `kubectl-astra`。

+
[source, console]
----
ls kubectl-astra/
----
. 正しいバイナリを現在のパスに移動し、名前をに変更します `kubectl-astra`：
+
[source, console]
----
cp kubectl-astra/<binary-name> /usr/local/bin/kubectl-astra
----




== イメージをローカルレジストリに追加します

. コンテナエンジンに応じた手順を実行します。


[role="tabbed-block"]
====
.Docker です
--
. をに変更します `acc` tarバンドルから抽出されたディレクトリ：
+
例



[listing]
----
cd ../acc
----
. [[[[</Z1>[</Z1>[</Z1>[</Z1>[</Z1>[</Z1>[</Z1>[</Z1></Z1>_image_local_registry_push]]]]]]]]]]</Z2>アストラControl Centerイメージディレクトリ内のパッケージイメージをローカルレジストリにプッシュします。</Z3>コマンドを実行する前に、次の置き換えを行ってください。
+
** <BUNDLE_FILE> をAstra Controlバンドルファイルの名前に置き換えます (`acc.manifest.yaml`）。
** <MY_FULL_REGISTRY_PATH> をDockerリポジトリのURLに置き換えます。次に例を示します。 https://exampledownloads.jfrog.io/docker-astra-control/v1/[]。
** <MY_REGISTRY_USER> をユーザ名に置き換えます。
** <MY_REGISTRY_TOKEN> をレジストリの認証済みトークンに置き換えます。
+
[source, console]
----
kubectl astra packages push-images -m <BUNDLE_FILE> -r <MY_FULL_REGISTRY_PATH> -u <MY_REGISTRY_USER> -p <MY_REGISTRY_TOKEN>
----




--
.ポドマン
--
. レジストリにログインします。
+
[source, console]
----
podman login <MY_FULL_REGISTRY_PATH>
----
. 次のスクリプトを実行して、コメントに記載されているように<your _registry>を置き換えます。
+
[source, console]
----
# You need to be at the root of the tarball.
# You should see these files to confirm correct location:
#   acc.manifest.yaml
#   acc/

# Replace <YOUR_REGISTRY> with your own registry (e.g registry.customer.com or registry.customer.com/testing, etc..)
export REGISTRY=<YOUR_REGISTRY>
export PACKAGENAME=acc
export PACKAGEVERSION=22.11.0-82
export DIRECTORYNAME=acc
for astraImageFile in $(ls ${DIRECTORYNAME}/images/*.tar) ; do
  # Load to local cache
  astraImage=$(podman load --input ${astraImageFile} | sed 's/Loaded image(s): //')

  # Remove path and keep imageName.
  astraImageNoPath=$(echo ${astraImage} | sed 's:.*/::')

  # Tag with local image repo.
  podman tag ${astraImage} ${REGISTRY}/netapp/astra/${PACKAGENAME}/${PACKAGEVERSION}/${astraImageNoPath}

  # Push to the local repo.
  podman push ${REGISTRY}/netapp/astra/${PACKAGENAME}/${PACKAGEVERSION}/${astraImageNoPath}
done
----


--
====


== オペレータインストールページを検索します

. 次のいずれかの手順を実行して、オペレータインストールページにアクセスします。
+
** Red Hat OpenShift の Web コンソールから：image:openshift_operatorhub.png["Astra Control Center のインストールページ"]
+
... OpenShift Container Platform UI にログインします。
... サイドメニューから、 * 演算子 > OperatorHub * を選択します。
... NetApp Astra Control Center オペレータを選択します。
... 「 * Install * 」を選択します。


** Red Hat エコシステムカタログから：image:red_hat_catalog.png["Astra Control Center の概要ページ"]
+
... NetApp Astra Control Center を選択します https://catalog.redhat.com/software/operators/detail/611fd22aaf489b8bb1d0f274["演算子"]。
... [Deploy and Use] を選択します。








== オペレータをインストールします

. 「 * インストールオペレータ * 」ページに必要事項を入力し、オペレータをインストールします。
+

NOTE: オペレータはすべてのクラスタネームスペースで使用できます。

+
.. operator 名前空間または NetApp-acc-operator' 名前空間を選択すると、オペレータのインストール時に自動的に作成されます。
.. 手動または自動の承認方法を選択します。
+

NOTE: 手動による承認が推奨されます。1 つのクラスタで実行する演算子インスタンスは 1 つだけです。

.. 「 * Install * 」を選択します。
+

NOTE: 手動承認方式を選択した場合は、このオペレータの手動インストール計画を承認するように求められます。



. コンソールで、 OperatorHub メニューに移動して、オペレータが正常にインストールされたことを確認します。




== Astra Control Center をインストールします

. Astra Control Center オペレータの詳細ビュー内のコンソールから、 [Provided API] セクションの [Create instance] を選択します。
. Create AstraControlCenter フォーム・フィールドに次のように入力します
+
.. Astra Control Center の名前を保持または調整します。
.. （オプション） AutoSupport を有効または無効にします。Auto Support 機能の保持を推奨します。
.. Astra Control Center のアドレスを入力します。アドレスには 'http://' または https:// を入力しないでください
.. Astra Control Center のバージョンを入力します。たとえば、 21.12.60 と入力します。
.. アカウント名、 E メールアドレス、および管理者の姓を入力します。
.. デフォルトのボリューム再利用ポリシーをそのまま使用します。
.. * Image Registry * に、ローカルコンテナイメージのレジストリパスを入力します。アドレスには 'http://' または https:// を入力しないでください
.. 認証が必要なレジストリを使用する場合は、シークレットを入力します。
.. 管理者の名を入力します。
.. リソースの拡張を構成する。
.. デフォルトのストレージクラスは保持します。
.. CRD 処理の環境設定を定義します。


. 「 Create 」を選択します。




== 次の手順

Astra Control Center が正しくインストールされたことを確認し、を完了します link:../get-started/install_acc.html#verify-system-status["残りのステップ"] ログインしてください。さらに、の導入も完了します link:setup_overview.html["セットアップのタスク"]。
